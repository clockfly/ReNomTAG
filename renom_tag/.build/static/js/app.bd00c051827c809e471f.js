webpackJsonp([1],{"0lA4":function(t,e){},"3kFY":function(t,e){},"5W1q":function(t,e){},"9wo7":function(t,e){},CpNp:function(t,e){},"KR/A":function(t,e){},LGmM:function(t,e){},NADg:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("7+uW"),n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var s=a("VU/8")({name:"App"},n,!1,function(t){a("CpNp")},null,null).exports,r=a("/ocq"),o=a("Dd8w"),l=a.n(o),c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("header",[e("i",{staticClass:"fa fa-bars",attrs:{id:"toggle-menu","aria-hidden":"true"},on:{click:this.toggleMenuVisible}}),this._v(" "),this._m(0)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tool-name"},[e("span",{staticClass:"bold"},[this._v("ReNom")]),this._v(" TAG")])}]};var _=a("VU/8")({name:"AppHeader",methods:{toggleMenuVisible:function(){var t=this.$store.state.main_menu_visible;this.$store.commit("set_main_menu_visible",{visible:!t})}}},c,!1,function(t){a("Zzh8")},null,null).exports,u=a("NYxO"),d={computed:Object(u.c)(["main_menu_visible"]),methods:{closeMenu:function(){this.$store.commit("set_main_menu_visible",{visible:!1})}}},f={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{class:{open:this.main_menu_visible},attrs:{id:"left-menu"},on:{click:this.closeMenu}},[this._m(0)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"left-menu-bar"},[e("button",{staticClass:"bar-button"},[e("i",{staticClass:"fa fa-object-group fa-fw",attrs:{"aria-hidden":"true"}}),this._v(" "),e("span",{staticClass:"menu-text"},[this._v("Detection Label")])]),this._v(" "),e("button",{staticClass:"bar-button"},[e("i",{staticClass:"fa fa-cog fa-fw",attrs:{"aria-hidden":"true"}}),this._v(" "),e("span",{staticClass:"menu-text"},[this._v("Settings")])])])}]};var m=a("VU/8")(d,f,!1,function(t){a("qlgc")},null,null).exports,v=a("fZjL"),h=a.n(v),g=a("BO1k"),b=a.n(g),x=a("d7EF"),p=a.n(x),w="";function y(t){return w.length?w+t:t}function k(t,e){return t<e?t:e}function C(t,e){return t>e?t:e}function $(t,e){var a=t.getBoundingClientRect(),i=[],n=!0,s=!1,r=void 0;try{for(var o,l=b()(e);!(n=(o=l.next()).done);n=!0){var c=o.value,_=p()(c,2),u=_[0],d=_[1];i.push([u-a.left+t.scrollLeft,d-a.top+t.scrollTop])}}catch(t){s=!0,r=t}finally{try{!n&&l.return&&l.return()}finally{if(s)throw r}}return i}function O(t){var e=p()(t,4),a=e[0],i=e[1],n=e[2],s=e[3];return[k(a,n),k(i,s),C(a,n),C(i,s)]}function R(t,e,a,i){t.addEventListener(e,function n(s){t.removeEventListener(e,n,i),a(s)},i)}var A={created:function(){this.$store.dispatch("load_imagefile_list")},data:function(){return{IMAGE_RELOAD_MARGIN:100,IMAGE_RELOAD_AMOUNT:300}},computed:l()({},Object(u.c)(["loading_message","files","filename_max_display","active_image_filename"]),{file_list_top:function(){return this.files?this.files.slice(0,this.filename_max_display):[]},file_list:function(){var t=this,e=[];return h()(this.files).sort(function(t,e){return t-e}).forEach(function(a){return e.push(t.files[a])}),e}}),watch:{active_image_filename:function(t,e){var a=this.files.indexOf(t);if(-1!==a){var i=this.$el.querySelector("#imagelist img:nth-child("+(a+1)+")");if(i){var n=i.getBoundingClientRect(),s=this.$el.querySelector("#imagelist"),r=s.getBoundingClientRect();if(n.bottom>=r.bottom){var o=n.bottom-r.bottom;s.scrollBy(0,o+r.height/4)}else if(n.top<r.top){var l=n.top-r.top-r.height/4;s.scrollBy(0,l)}}}}},methods:{get_image_url:function(t){return y("/t/"+t)},is_selected:function(t){return t===this.active_image_filename},select_image:function(t){t.target.dataset.file!==this.active_image_filename&&this.$store.dispatch("load_current_image",t.target.dataset.file)},on_scroll:function(t){if(this.filename_max_display<this.files.length){var e=this.filename_max_display-this.IMAGE_RELOAD_MARGIN;e<=0&&(e=1);var a=this.$el.querySelector("#imagelist img:nth-child("+e+")");if(null===a)return;var i=a.getBoundingClientRect(),n=this.$el.querySelector("#imagelist").getBoundingClientRect();i.top<=n.top&&this.$store.commit("set_filename_max_display",{max_display:this.filename_max_display+this.IMAGE_RELOAD_AMOUNT})}}}},M={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"imagelistblock"}},[0===t.file_list.length?a("div",{attrs:{id:"msg_no_image"}},[t._v("\n    "+t._s(t.loading_message)+"\n  ")]):t._e(),t._v(" "),a("div",{attrs:{id:"imagelist"},on:{scroll:t.on_scroll}},t._l(t.file_list_top,function(e){return a("img",{key:e,class:{selected:t.is_selected(e)},attrs:{src:t.get_image_url(e),"data-file":e},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.select_image(e)}}})}))])},staticRenderFns:[]};var E=a("VU/8")(A,M,!1,function(t){a("KR/A")},"data-v-75472fe0",null).exports,D={name:"NavArrow",props:["dir"],computed:l()({},Object(u.c)(["files","active_image_filename"]),{next_file:function(){return"back"===this.dir?this.get_back_name():this.get_fore_name()}}),methods:{get_back_name:function(){var t=this.files.indexOf(this.active_image_filename);if(t>0)return this.files[t-1]},get_fore_name:function(){var t=this.files.indexOf(this.active_image_filename);if(-1!==t&&t<this.files.length-1)return this.files[t+1]},on_click:function(t){var e=this.next_file;e&&this.$store.dispatch("load_current_image",e)}}},N={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"navarrow",on:{click:this.on_click}},[this.next_file?e("div",{class:["arrow",this.dir+"_arrow"]}):this._e()])},staticRenderFns:[]};var B=a("VU/8")(D,N,!1,function(t){a("NADg")},null,null).exports,L={data:function(){return{BOX_MARGIN:2,BOX_BORDER:3,status:"",dragfrom_x:null,dragfrom_y:null,newbox_rect:null,org_boxrc:null,boxes:null}},created:function(){window.addEventListener("resize",this.on_resize),window.addEventListener("keyup",this.on_keyup)},beforeDestroy:function(){window.removeEventListener("resize",this.on_resize),window.removeEventListener("keyup",this.on_keyup)},mounted:function(){setTimeout(this.arrange_boxes,20)},computed:l()({},Object(u.c)(["active_image_filename","active_image","active_image_height","active_image_width","active_image_tag_boxes","active_boxid","labels"]),{image_url:function(){return this.active_image},has_image:function(){return Boolean(this.active_image_filename)},img_file_name:function(){var t=this.active_image_filename.search(/[/\\]/);return this.active_image_filename.slice(t+1)},canbesaved:function(){if(0===this.active_image_tag_boxes.length)return!1;var t=!0,e=!1,a=void 0;try{for(var i,n=b()(this.active_image_tag_boxes);!(t=(i=n.next()).done);t=!0){if(!i.value.label)return!1}}catch(t){e=!0,a=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw a}}return!0}}),watch:{active_image_tag_boxes:function(){this.arrange_boxes()}},methods:l()({},Object(u.b)(["set_active_boxid"]),{newtag_style:function(){var t=this.to_canvas_rect(this.newbox_rect);return this.size_style(t)},on_drag_start:function(t){return!1},is_creating:function(){return"new"===this.status},is_active_box:function(t){return this.active_boxid===t},get_box:function(t){return this.active_image_tag_boxes[t]},get_box_label:function(t){return this.get_box(t).label},to_canvas_rect:function(t){var e=O(t),a=p()(e,4),i=a[0],n=a[1],s=a[2],r=a[3],o=$(this.$refs.canvaspanel,[[i,n],[s,r]]),l=p()(o,2),c=p()(l[0],2);i=c[0],n=c[1];var _=p()(l[1],2);return[i,n,s=_[0],r=_[1]]},on_resize:function(){this.arrange_boxes(),setTimeout(this.arrange_boxes,10)},on_keyup:function(t){if("BODY"===t.target.nodeName){if(" "===t.key&&this.canbesaved)return this.save_tags(),t.preventDefault(),t.stopPropagation(),!1;if(this.has_image&&null!==this.active_boxid){if("Delete"===t.key||"Backspace"===t.key)return this.$store.commit("remove_tagbox",{boxid:this.active_boxid}),t.preventDefault(),t.stopPropagation(),!1;var e=!0,a=!1,i=void 0;try{for(var n,s=b()(this.labels);!(e=(n=s.next()).done);e=!0){var r=n.value;if(r.shortcut===t.key)return this.$store.commit("set_activebox_label",r),t.preventDefault(),t.stopPropagation(),!1}}catch(t){a=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(a)throw i}}}}},size_style:function(t){return{left:t[0]+"px",top:t[1]+"px",width:t[2]-t[0]+"px",height:t[3]-t[1]+"px"}},calc_image_rect:function(){var t=this.$refs.canvas.getBoundingClientRect(),e=this.active_image_width,a=this.active_image_height,i=k(t.width/e,t.height/a),n=C(0,(t.width-e*i)/2),s=t.left+n,r=Math.floor(s+e*i);return[i,[s,t.top,r,Math.floor(t.top+a*i)]]},box_to_client:function(t){var e=this.calc_image_rect(),a=p()(e,2),i=a[0],n=a[1];return[Math.floor(t.left*i+n[0]),Math.floor(t.top*i+n[1]),Math.floor(t.right*i+n[0]),Math.floor(t.bottom*i+n[1])]},client_to_box:function(t){var e=O(t),a=p()(e,4),i=a[0],n=a[1],s=a[2],r=a[3],o=this.calc_image_rect(),l=p()(o,2),c=l[0],_=l[1];return{left:i=Math.floor((i-_[0])/c),top:n=Math.floor((n-_[1])/c),right:s=Math.floor((s-_[0])/c),bottom:r=Math.floor((r-_[1])/c)}},arrange_boxes:function(){var t=[];if(this.$refs.canvas&&this.active_image_tag_boxes){var e=!0,a=!1,i=void 0;try{for(var n,s=b()(this.active_image_tag_boxes);!(e=(n=s.next()).done);e=!0){var r=n.value,o=this.to_canvas_rect(this.box_to_client(r));t.push(this.size_style([o[0]-this.BOX_MARGIN,o[1]-this.BOX_MARGIN,o[2]+this.BOX_MARGIN,o[3]+this.BOX_MARGIN]))}}catch(t){a=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(a)throw i}}this.boxes=t}},_clean_boxes:function(){var t=[],e=!0,a=!1,i=void 0;try{for(var n,s=b()(this.active_image_tag_boxes);!(e=(n=s.next()).done);e=!0){var r=n.value;r.label&&t.push(r)}}catch(t){a=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(a)throw i}}this.$store.commit("set_tagboxes",{tagboxes:t})},on_click:function(t){if(this.has_image){var e=this.calc_image_rect(),a=p()(e,2)[1];if(a[2]=a[2]-1,i=a,n=t.clientX,s=t.clientY,r=O(i),o=p()(r,4),l=o[0],c=o[1],_=o[2],u=o[3],n>=l&&n<_&&s>=c&&s<u){var i,n,s,r,o,l,c,_,u;this._clean_boxes();var d=[t.clientX,t.clientY];this.dragfrom_x=d[0],this.dragfrom_y=d[1],this.status="new",this.newbox_rect=[this.dragfrom_x,this.dragfrom_y,this.dragfrom_x,this.dragfrom_y],R(document,"mouseup",this.end_drag,!0)}}},box_getcursor_type:function(t,e,a){var i=t.getBoundingClientRect(),n=2*this.BOX_MARGIN+this.BOX_BORDER;return e-i.left<=n?a-i.top<=n?"nw":i.bottom-a<=n?"sw":"w":i.right-e<=n?a-i.top<=n?"ne":i.bottom-a<=n?"se":"e":a-i.top<=n?"n":i.bottom-a<=n?"s":""},on_boxclick:function(t){var e=t.currentTarget.dataset.boxid;if(e!==this.active_boxid&&this._clean_boxes(),this.get_box(e)){var a=this.box_getcursor_type(t.currentTarget,t.clientX,t.clientY);this.status=""===a?"dragging":a,this.set_active_boxid({boxid:parseInt(e)});var i=this.get_box(this.active_boxid);this.org_boxrc=this.box_to_client(i);var n=[t.clientX,t.clientY];this.dragfrom_x=n[0],this.dragfrom_y=n[1],R(document,"mouseup",this.end_drag,!0)}},dir_to_cursor:function(t){return{n:"ns-resize",nw:"nwse-resize",ne:"nesw-resize",w:"ew-resize",e:"ew-resize",s:"ns-resize",sw:"nesw-resize",se:"nwse-resize"}[t]},on_boxmousemove:function(t){var e=this.status;e||(e=this.box_getcursor_type(t.currentTarget,t.clientX,t.clientY));var a=this.dir_to_cursor(e);a||(a="move"),t.target.style.cursor=a},on_mousemove:function(t){if(this.has_image){var e=this.calc_image_rect(),a=p()(e,2)[1],i=k(C(a[0],t.clientX),a[2]),n=k(C(a[1],t.clientY),a[3]);if("new"===this.status){var s=p()(this.newbox_rect,2),r=s[0],o=s[1];this.newbox_rect=[r,o,i,n]}else if(this.status){var c=this.org_boxrc.slice(),_=i-this.dragfrom_x,u=n-this.dragfrom_y;"dragging"===this.status?(c[0]-a[0]+_<0&&(_=-1*(c[0]-a[0])),c[2]+_>a[2]&&(_=a[2]-c[2]),c[1]-a[1]+u<0&&(u=-1*(c[1]-a[1])),c[3]+u>a[3]&&(u=a[3]-c[3]),c[0]+=_,c[2]+=_,c[1]+=u,c[3]+=u):(-1!==this.status.indexOf("n")&&(c[1]=k(C(a[1],c[1]+u),c[3]-1)),-1!==this.status.indexOf("s")&&(c[3]=k(C(c[1],c[3]+u),a[3])),-1!==this.status.indexOf("w")&&(c[0]=k(C(a[0],c[0]+_),c[2]-1)),-1!==this.status.indexOf("e")&&(c[2]=k(C(c[0],c[2]+_),a[2]-1)));var d=this.get_box(this.active_boxid),f=l()({},d,this.client_to_box(c));this.$store.commit("set_tagbox",{boxid:this.active_boxid,box:f})}}},end_drag:function(){if("new"===this.status){var t=this.client_to_box(this.newbox_rect);t.left!==t.right&&t.top!==t.bottom&&(this.$store.commit("new_tagbox",{box:t}),this.set_active_boxid({boxid:this.active_image_tag_boxes.length-1}))}this.status=""},save_tags:function(){this.$store.dispatch("save_annotation")}})},z={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"canvasblock"}},[a("div",{ref:"canvaspanel",attrs:{id:"canvaspanel"},on:{mousedown:function(e){return e.stopPropagation(),t.on_click(e)},mousemove:function(e){return e.stopPropagation(),e.preventDefault(),t.on_mousemove(e)}}},[t.has_image?a("img",{ref:"canvas",attrs:{id:"canvas",src:t.image_url},on:{dragstart:function(e){return e.stopPropagation(),e.preventDefault(),t.on_drag_start(e)}}}):t._e(),t._v(" "),t.is_creating()?a("div",{style:t.newtag_style(),attrs:{id:"newtag"}}):t._e(),t._v(" "),t._l(t.boxes,function(e,i){return a("div",{key:i,staticClass:"box-border",style:e,attrs:{"data-boxid":i},on:{mousedown:function(e){return e.stopPropagation(),e.preventDefault(),t.on_boxclick(e)},mousemove:t.on_boxmousemove}},[a("div",{class:["box",t.is_active_box(i)?"box-active":""]},[a("div",{staticClass:"taglabel"},[t._v(t._s(t.get_box_label(i)))])])])})],2),t._v(" "),a("div",{attrs:{id:"imageinfo"}},[a("div",[t._v(t._s(t.img_file_name))]),t._v(" "),a("button",{attrs:{id:"save_xml_btn",disabled:!t.canbesaved},on:{click:t.save_tags}},[t._v("\n      Save "),a("span",{staticClass:"save_xml_btn_arrow"},[t._v(">>")])])])])},staticRenderFns:[]};var j=a("VU/8")(L,z,!1,function(t){a("uk43")},"data-v-379f8453",null).exports,G={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"modal"}},[a("div",{staticClass:"modal-mask"},[a("div",{staticClass:"modal-wrapper"},[a("div",{staticClass:"modal-container"},[t._t("contents",[t._v("\n          default content\n        ")]),t._v(" "),a("div",{staticClass:"modal-footer"},[t._t("footer",[t._t("okbutton",[a("button",{staticClass:"modal-default-button",on:{click:function(e){t.$emit("ok")}}},[t._v("\n                Ok\n              ")])]),t._v(" "),t._t("cancelbutton",[a("button",{staticClass:"modal-default-button",on:{click:function(e){t.$emit("cancel")}}},[t._v("\n                Cancel\n              ")])])])],2)],2)])])])},staticRenderFns:[]};var U=a("VU/8")({},G,!1,function(t){a("3kFY")},null,null).exports,P={components:{"modal-box":U},data:function(){return{label:"",shortcut:"",show_delete_dialog:!1}},created:function(){this.$store.dispatch("load_label_candidates_dict")},computed:l()({},Object(u.c)(["labels"]),{errormsg:function(){if(this.label.length&&!this.label.match("^[0-9a-z-A-Z]+$"))return"Class name must be alphanumeric single-byte.";var t=!0,e=!1,a=void 0;try{for(var i,n=b()(this.labels);!(t=(i=n.next()).done);t=!0){var s=i.value,r=s.label,o=s.shortcut;if(r===this.label)return"Please set unique label.";if(this.shortcut&&o===this.shortcut)return"Shortcut is already exists."}}catch(t){e=!0,a=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw a}}return""},is_valid_label:function(){return!!this.label.length&&""===this.errormsg}}),methods:{addNewLabel:function(){this.$store.dispatch("add_label",{label:this.label,shortcut:this.shortcut}),this.label=this.shortcut="",document.body.focus()},is_control_key:function(t){return[13,32,8,9,46].indexOf(t)>=0},keydown:function(t){if(46===t.keyCode||8===t.keyCode)return this.shortcut="",void t.preventDefault();this.is_control_key(t.keyCode)||t.preventDefault()},setShortcutKey:function(t){this.is_control_key(t.keyCode)||(this.shortcut=t.key)},on_click:function(t){var e=t.currentTarget.dataset.label;this.$store.commit("set_activebox_label",{label:e})},delete_tags:function(t){this.$store.commit("set_labels",[]),this.show_delete_dialog=!1}}},X={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"tags"}},[a("div",{attrs:{id:"tag-list-header"}},[t._v("\n    Class List\n  ")]),t._v(" "),a("form",{attrs:{id:"add-new-label-form"}},[a("div",{staticClass:"add-new-label-input-area"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.label,expression:"label"}],staticClass:"label-text",attrs:{type:"text",placeholder:"label name..."},domProps:{value:t.label},on:{input:function(e){e.target.composing||(t.label=e.target.value)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.shortcut,expression:"shortcut"}],staticClass:"label-shortcut",attrs:{type:"text",placeholder:"key..."},domProps:{value:t.shortcut},on:{keydown:t.keydown,keyup:t.setShortcutKey,input:function(e){e.target.composing||(t.shortcut=e.target.value)}}})]),t._v(" "),t.errormsg?a("div",{staticClass:"label_errormsg"},[t._v(t._s(t.errormsg))]):t._e(),t._v(" "),a("button",{staticClass:"add-new-label-btn",attrs:{type:"button",disabled:!t.is_valid_label},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addNewLabel(e)}}},[t._v("Add New Label")])]),t._v(" "),a("div",{attrs:{id:"tag-tree"}},[a("ul",{staticClass:"tag-list"},t._l(t.labels,function(e){var i=e.label,n=e.shortcut;return a("li",{key:i,staticClass:"tag-list-item",attrs:{"data-label":i},on:{click:t.on_click}},[a("div",{staticClass:"label-text"},[t._v(t._s(i))]),t._v(" "),n?a("div",{staticClass:"label-shortcut"},[t._v(t._s(n))]):t._e()])}))]),t._v(" "),a("button",{attrs:{id:"remove-button"},on:{click:function(e){t.show_delete_dialog=!0}}},[t._v("Refresh list")]),t._v(" "),t.show_delete_dialog?a("modal-box",{on:{ok:t.delete_tags,cancel:function(e){t.show_delete_dialog=!1}}},[a("div",{attrs:{slot:"contents"},slot:"contents"},[t._v("\n      Are you sure flushing class list?\n    ")]),t._v(" "),a("span",{attrs:{slot:"okbutton"},slot:"okbutton"},[a("button",{staticClass:"modal-default-button",attrs:{id:"delete_labels_button"},on:{click:t.delete_tags}},[t._v("\n        Delete labels\n      ")])])]):t._e()],1)},staticRenderFns:[]};var F=a("VU/8")(P,X,!1,function(t){a("Ya7h")},null,null).exports,I={computed:l()({},Object(u.c)(["tagged_images"])),methods:{ratio:function(t){return 200/t.height},imagewidth:function(t){var e=this.ratio(t);return t.width*e},boxstyles:function(t,e){var a=this.ratio(t);return{left:e.left*a+"px",top:e.top*a+"px",width:(e.right-e.left)*a+"px",height:(e.bottom-e.top)*a+"px"}},on_click:function(t){var e=t.currentTarget.dataset.filename;this.$store.dispatch("load_current_image",e)}}},T={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"tagged-images"}},[t._m(0),t._l(t.tagged_images,function(e){return a("div",{key:e.filename,staticClass:"tagged-image",style:{"background-image":"url("+e.image+")",width:t.imagewidth(e)+"px"},attrs:{"data-filename":e.filename},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.on_click(e)}}},t._l(e.boxes,function(i,n){return a("div",{key:n,staticClass:"image-box",style:t.boxstyles(e,i)},[a("div",{staticClass:"taglabel"},[t._v(t._s(i.label))])])}))})],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"labelbox"},[e("div",{staticClass:"label_text"},[this._v("Labeled"),e("br"),this._v("Images")])])}]};var V={components:{"app-header":_,"left-menu":m,"image-list":E,tagcanvas:j,tags:F,"tagged-images":a("VU/8")(I,T,!1,function(t){a("9wo7")},"data-v-18abb8b0",null).exports,navarrow:B,"modal-box":U},computed:l()({},Object(u.c)(["active_image_filename","error_status"])),methods:l()({},Object(u.b)(["set_error_status"]))},Y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"page"}},[a("app-header"),t._v(" "),a("div",{attrs:{id:"main-container"}},[a("left-menu"),t._v(" "),a("image-list"),t._v(" "),a("navarrow",{attrs:{dir:"back"}}),t._v(" "),null===t.active_image_filename?a("div",{staticClass:"filler"}):t._e(),t._v(" "),null!=t.active_image_filename?a("tagcanvas"):t._e(),t._v(" "),a("navarrow",{attrs:{dir:"forward"}}),t._v(" "),a("tags")],1),t._v(" "),a("tagged-images"),t._v(" "),t.error_status?a("modal-box",[a("div",{staticClass:"error-msg",attrs:{slot:"contents"},slot:"contents"},[t._v("\n      "+t._s(t.error_status)+"\n    ")]),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("button",{staticClass:"error-button",on:{click:function(e){t.set_error_status({error_status:""})}}},[t._v("close")])])]):t._e()],1)},staticRenderFns:[]};var q=a("VU/8")(V,Y,!1,function(t){a("tDxK")},null,null).exports;i.a.use(r.a);var S=new r.a({routes:[{path:"/",name:"TaggerPage",component:q}]}),K={error_status:"",main_menu_visible:!1,loading_message:"Loading images...",files:[],filename_max_display:0,active_image_filename:null,active_image:{},active_boxid:null,active_image_tag_boxes:[],labels:[],tagged_images:[]},Z=a("woOf"),W=a.n(Z),H=a("Gu7T"),J=a.n(H);function Q(t,e){var a=t.active_image_tag_boxes.slice(0,e.boxid),i=t.active_image_tag_boxes.slice(e.boxid+1);t.active_image_tag_boxes=[].concat(J()(a),[e.box],J()(i))}var tt,et={set_error_status:function(t,e){t.error_status=e.error_status},set_loading_message:function(t,e){t.loading_message=e.loading_message},set_main_menu_visible:function(t,e){t.main_menu_visible=e.visible},set_file_list:function(t,e){t.files=e.file_list,t.filename_max_display=100,t.files&&0!==t.files.length||(t.loading_message="No images found.")},set_filename_max_display:function(t,e){t.filename_max_display=e.max_display},remove_image:function(t,e){var a=[],i=!0,n=!1,s=void 0;try{for(var r,o=b()(t.files);!(i=(r=o.next()).done);i=!0){var l=r.value;e.filename!==l&&a.push(l)}}catch(t){n=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(n)throw s}}t.files=a},set_active_image:function(t,e){t.active_image_filename=e.filename,t.active_image_width=e.width,t.active_image_height=e.height,t.active_image=e.image,t.active_image_tag_boxes=e.boxes,t.active_boxid=null},set_active_boxid:function(t,e){t.active_boxid=e.boxid},new_tagbox:function(t,e){t.active_image_tag_boxes=[].concat(J()(t.active_image_tag_boxes),[e.box])},set_tagbox:function(t,e){Q(t,e)},set_tagboxes:function(t,e){t.active_image_tag_boxes=e.tagboxes},remove_tagbox:function(t,e){var a=t.active_image_tag_boxes.slice(0,e.boxid),i=t.active_image_tag_boxes.slice(e.boxid+1);t.active_image_tag_boxes=[].concat(J()(a),J()(i)),t.active_boxid=null},set_activebox_label:function(t,e){var a=t.active_boxid;if(null!==a){var i=t.active_image_tag_boxes[a];Q(t,{boxid:a,box:W()(i,{label:e.label})})}},set_dragger:function(t,e){t.dragger=null===e?{}:l()({},t.dragger,e)},add_label:function(t,e){t.labels=[].concat(J()(t.labels),[e])},set_labels:function(t,e){t.labels=e},add_tagged_image:function(t,e){var a=[e],i=0,n=!0,s=!1,r=void 0;try{for(var o,l=b()(t.tagged_images);!(n=(o=l.next()).done);n=!0){var c=o.value;if(c.filename!==e.filename&&a.push(c),(i+=c.width*(c.height/200))>1e4)break}}catch(t){s=!0,r=t}finally{try{!n&&l.return&&l.return()}finally{if(s)throw r}}t.tagged_images=a}},at=a("Xxa5"),it=a.n(at),nt=a("exGp"),st=a.n(nt),rt=a("mtWM"),ot=a.n(rt),lt=(tt=st()(it.a.mark(function t(e,a){var i;return it.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=void 0,t.prev=1,t.next=4,a();case 4:i=t.sent,t.next=12;break;case 7:throw t.prev=7,t.t0=t.catch(1),e.commit("set_error_status",{error_status:"Failed to connect server"}),console.error(t.t0),t.t0;case 12:return t.abrupt("return",i);case 13:case"end":return t.stop()}},t,this,[[1,7]])})),function(t,e){return tt.apply(this,arguments)}),ct={load_imagefile_list:function(t){var e=this;return st()(it.a.mark(function a(){var i;return it.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.commit("set_loading_message",{loading_message:"Loading images..."}),e.next=3,lt(t,function(){return ot.a.post(y("/api/get_filename_list"))});case 3:i=e.sent,t.commit("set_file_list",{file_list:i.data.filename_list}),t.state.files.length>0&&t.dispatch("load_current_image",t.state.files[0]);case 6:case"end":return e.stop()}},a,e)}))()},load_current_image:function(t,e){var a=this;return st()(it.a.mark(function i(){var n,s,r,o,l,c,_,u;return it.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.commit("set_active_image",{file:null}),a.next=3,lt(t,function(){return ot.a.get(y("/api/get_raw_img/"+e))});case 3:if(n=a.sent,s=[],!n.data.boxes||!n.data.boxes.annotation){a.next=25;break}for(r=!0,o=!1,l=void 0,a.prev=9,c=b()(n.data.boxes.annotation.object);!(r=(_=c.next()).done);r=!0)u=_.value,s.push({label:u.name,left:u.bndbox.xmin,right:u.bndbox.xmax,top:u.bndbox.ymin,bottom:u.bndbox.ymax});a.next=17;break;case 13:a.prev=13,a.t0=a.catch(9),o=!0,l=a.t0;case 17:a.prev=17,a.prev=18,!r&&c.return&&c.return();case 20:if(a.prev=20,!o){a.next=23;break}throw l;case 23:return a.finish(20);case 24:return a.finish(17);case 25:t.commit("set_active_image",{filename:e,width:n.data.width,height:n.data.height,image:"data:image;base64,"+n.data.img,boxes:s});case 26:case"end":return a.stop()}},i,a,[[9,13,17,25],[18,,20,24]])}))()},add_label:function(t,e){var a=this;return st()(it.a.mark(function i(){return it.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.commit("add_label",e),a.next=3,lt(t,function(){return ot.a.post(y("/api/save_label_candidates_dict"),t.state.labels)});case 3:case"end":return a.stop()}},i,a)}))()},load_label_candidates_dict:function(t,e){var a=this;return st()(it.a.mark(function e(){var i;return it.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lt(t,function(){return ot.a.post(y("/api/load_label_candidates_dict"),t.state.labels)});case 2:i=e.sent,t.commit("set_labels",i.data);case 4:case"end":return e.stop()}},e,a)}))()},save_annotation:function(t){var e=this;return st()(it.a.mark(function a(){var i,n,s,r,o,l,c,_,u,d,f,m,v,h,g,x;return it.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(i=t.state.active_image_filename,n={annotation:{path:i,source:{database:"Unknown"},size:{width:t.state.active_image_width,height:t.state.active_image_height,depth:3},segments:0,objects:[]}},s=!0,r=!1,o=void 0,e.prev=5,l=b()(t.state.active_image_tag_boxes);!(s=(c=l.next()).done);s=!0)_=c.value,u={object:{name:_.label,pose:"Unspecified",truncated:0,difficult:0,bndbox:{xmin:_.left,xmax:_.right,ymin:_.top,ymax:_.bottom}}},n.annotation.objects.push(u);e.next=13;break;case 9:e.prev=9,e.t0=e.catch(5),r=!0,o=e.t0;case 13:e.prev=13,e.prev=14,!s&&l.return&&l.return();case 16:if(e.prev=16,!r){e.next=19;break}throw o;case 19:return e.finish(16);case 20:return e.finish(13);case 21:return e.next=23,lt(t,function(){return ot.a.post(y("/api/save_xml_from_label_dict"),n)});case 23:t.commit("add_tagged_image",{filename:i,width:t.state.active_image_width,height:t.state.active_image_height,image:t.state.active_image,boxes:t.state.active_image_tag_boxes}),d=0,f=!0,m=!1,v=void 0,e.prev=28,h=b()(t.state.files);case 30:if(f=(g=h.next()).done){e.next=38;break}if(x=g.value,i!==x){e.next=34;break}return e.abrupt("break",38);case 34:d+=1;case 35:f=!0,e.next=30;break;case 38:e.next=44;break;case 40:e.prev=40,e.t1=e.catch(28),m=!0,v=e.t1;case 44:e.prev=44,e.prev=45,!f&&h.return&&h.return();case 47:if(e.prev=47,!m){e.next=50;break}throw v;case 50:return e.finish(47);case 51:return e.finish(44);case 52:d<t.state.files.length-1?d+=1:d-=1,d>=0?t.dispatch("load_current_image",t.state.files[d]):t.commit("set_active_image",{file:null}),t.commit("remove_image",{filename:i});case 55:case"end":return e.stop()}},a,e,[[5,9,13,21],[14,,16,20],[28,40,44,52],[45,,47,51]])}))()}},_t=a("UjVw"),ut=a.n(_t);i.a.use(u.a);var dt={state:K,actions:ct,mutations:et,getters:ut.a},ft=new u.a.Store(dt);a("xsZ7"),a("LGmM"),a("5W1q"),a("0lA4"),i.a.config.productionTip=!1,new i.a({el:"#app",store:ft,router:S,components:{App:s},template:"<App/>"})},UjVw:function(t,e){},Ya7h:function(t,e){},Zzh8:function(t,e){},qlgc:function(t,e){},tDxK:function(t,e){},uk43:function(t,e){},xsZ7:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.bd00c051827c809e471f.js.map